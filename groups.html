<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Заря — Группы</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  
  <!-- Шрифт Inter -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap">
  
  <!-- Собственные стили -->
  <link rel="stylesheet" href="styles.css">
  
  <!-- Telegram Web Apps SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
  <div class="page-wrapper">
    <header class="project-title">Проект Заря</header>
    <main>
      <div class="categories-container">
        <!-- Категория 1: Зависимости -->
        <div class="category-card" onclick="toggleCategory('cat1')">
          <div class="category-header">
            <span>Зависимости</span>
            <span id="icon-cat1">+</span>
          </div>
          <div id="cat1" class="chat-list">
            <div class="chat-item">
              <span>Наркомания</span>
              <a href="https://t.me/SafeSpace_DA_bot" target="_blank" class="btn" onclick="event.stopPropagation();">Вступить</a>
            </div>
            <div class="chat-item">
              <span>Алкоголизм</span>
              <a href="https://t.me/SafeSpace_AL_bot" target="_blank" class="btn" onclick="event.stopPropagation();">Вступить</a>
            </div>
            <div class="chat-item">
              <span>Лудомания</span>
              <a href="https://t.me/SafeSpace_LU_bot" target="_blank" class="btn" onclick="event.stopPropagation();">Вступить</a>
            </div>
          </div>
        </div>
        
        <!-- Категория 2: Психологическая поддержка -->
        <div class="category-card" onclick="toggleCategory('cat2')">
          <div class="category-header">
            <span>Психологическая поддержка</span>
            <span id="icon-cat2">+</span>
          </div>
          <div id="cat2" class="chat-list">
            <div class="chat-item">
              <span>Тревога и депрессия</span>
              <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
            </div>
            <div class="chat-item">
              <span>Булимия и анорексия</span>
              <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
            </div>
            <div class="chat-item">
              <span>Жертвы домашнего насилия</span>
              <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
            </div>
          </div>
        </div>
        
        <!-- Категория 3: Здоровье -->
        <div class="category-card" onclick="toggleCategory('cat3')">
          <div class="category-header">
            <span>Здоровье</span>
            <span id="icon-cat3">+</span>
          </div>
          <div id="cat3" class="chat-list">
            <div class="chat-item">
              <span>Онкология</span>
              <a href="https://t.me/SafeSpace_ON_bot" target="_blank" class="btn" onclick="event.stopPropagation();">Вступить</a>
            </div>
            <div class="chat-item">
              <span>ВИЧ инфицированные</span>
              <a href="https://t.me/SafeSpace_HI_bot" target="_blank" class="btn" onclick="event.stopPropagation();">Вступить</a>
            </div>
            <div class="chat-item">
              <span>Новички, начало терапии</span>
              <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
            </div>
          </div>
        </div>
        
        <!-- Категория 4: Сексуальность -->
        <div class="category-card" onclick="toggleCategory('cat4')">
          <div class="category-header">
            <span>Сексуальность</span>
            <span id="icon-cat4">+</span>
          </div>
          <div id="cat4" class="chat-list">
            <!-- Субкатегория 4а -->
            <div class="sub-category">
              <div class="sub-category-header" onclick="toggleSubCategory('sub4a'); event.stopPropagation();">
                <span>Позитивная сексуальность</span>
                <span id="icon-sub4a">+</span>
              </div>
              <div id="sub4a" class="sub-chat-list">
                <div class="chat-item">
                  <span>Обсуждение и поддержка</span>
                  <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
                </div>
              </div>
            </div>
            <!-- Субкатегория 4б -->
            <div class="sub-category">
              <div class="sub-category-header" onclick="toggleSubCategory('sub4b'); event.stopPropagation();">
                <span>Половое образование</span>
                <span id="icon-sub4b">+</span>
              </div>
              <div id="sub4b" class="sub-chat-list">
                <div class="chat-item">
                  <span>Информационный канал</span>
                  <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
                </div>
              </div>
            </div>
            <!-- Субкатегория 4в -->
            <div class="sub-category">
              <div class="sub-category-header" onclick="toggleSubCategory('sub4c'); event.stopPropagation();">
                <span>Проблемы интимной близости</span>
                <span id="icon-sub4c">+</span>
              </div>
              <div id="sub4c" class="sub-chat-list">
                <div class="chat-item">
                  <span>Поддержка и советы</span>
                  <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Категория 5: Родительство -->
        <div class="category-card" onclick="toggleCategory('cat5')">
          <div class="category-header">
            <span>Родительство</span>
            <span id="icon-cat5">+</span>
          </div>
          <div id="cat5" class="chat-list">
            <!-- Субкатегория 5а -->
            <div class="sub-category">
              <div class="sub-category-header" onclick="toggleSubCategory('sub5a'); event.stopPropagation();">
                <span>Новая мама/папа</span>
                <span id="icon-sub5a">+</span>
              </div>
              <div id="sub5a" class="sub-chat-list">
                <div class="chat-item">
                  <span>Обсуждение первых шагов</span>
                  <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
                </div>
              </div>
            </div>
            <!-- Субкатегория 5б -->
            <div class="sub-category">
              <div class="sub-category-header" onclick="toggleSubCategory('sub5b'); event.stopPropagation();">
                <span>Подростковое воспитание</span>
                <span id="icon-sub5b">+</span>
              </div>
              <div id="sub5b" class="sub-chat-list">
                <div class="chat-item">
                  <span>Советы и поддержка</span>
                  <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
                </div>
              </div>
            </div>
            <!-- Субкатегория 5в -->
            <div class="sub-category">
              <div class="sub-category-header" onclick="toggleSubCategory('sub5c'); event.stopPropagation();">
                <span>Семейные отношения</span>
                <span id="icon-sub5c">+</span>
              </div>
              <div id="sub5c" class="sub-chat-list">
                <div class="chat-item">
                  <span>Обсуждение и поддержка</span>
                  <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Категория 6: Потеря близкого -->
        <div class="category-card" onclick="toggleCategory('cat6')">
          <div class="category-header">
            <span>Потеря близкого</span>
            <span id="icon-cat6">+</span>
          </div>
          <div id="cat6" class="chat-list">
            <!-- Субкатегория 6а -->
            <div class="sub-category">
              <div class="sub-category-header" onclick="toggleSubCategory('sub6a'); event.stopPropagation();">
                <span>Горе и утрата</span>
                <span id="icon-sub6a">+</span>
              </div>
              <div id="sub6a" class="sub-chat-list">
                <div class="chat-item">
                  <span>Поддержка и советы</span>
                  <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
                </div>
              </div>
            </div>
            <!-- Субкатегория 6б -->
            <div class="sub-category">
              <div class="sub-category-header" onclick="toggleSubCategory('sub6b'); event.stopPropagation();">
                <span>Психологическая помощь</span>
                <span id="icon-sub6b">+</span>
              </div>
              <div id="sub6b" class="sub-chat-list">
                <div class="chat-item">
                  <span>Информация и поддержка</span>
                  <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
                </div>
              </div>
            </div>
            <!-- Субкатегория 6в -->
            <div class="sub-category">
              <div class="sub-category-header" onclick="toggleSubCategory('sub6c'); event.stopPropagation();">
                <span>Сообщество поддержки</span>
                <span id="icon-sub6c">+</span>
              </div>
              <div id="sub6c" class="sub-chat-list">
                <div class="chat-item">
                  <span>Общение и помощь</span>
                  <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Категория 7: Огромный вес -->
        <div class="category-card" onclick="toggleCategory('cat7')">
          <div class="category-header">
            <span>Огромный вес</span>
            <span id="icon-cat7">+</span>
          </div>
          <div id="cat7" class="chat-list">
            <!-- Субкатегория 7а -->
            <div class="sub-category">
              <div class="sub-category-header" onclick="toggleSubCategory('sub7a'); event.stopPropagation();">
                <span>Похудение и поддержка</span>
                <span id="icon-sub7a">+</span>
              </div>
              <div id="sub7a" class="sub-chat-list">
                <div class="chat-item">
                  <span>Советы и обмен опытом</span>
                  <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
                </div>
              </div>
            </div>
            <!-- Субкатегория 7б -->
            <div class="sub-category">
              <div class="sub-category-header" onclick="toggleSubCategory('sub7b'); event.stopPropagation();">
                <span>Психологическая поддержка</span>
                <span id="icon-sub7b">+</span>
              </div>
              <div id="sub7b" class="sub-chat-list">
                <div class="chat-item">
                  <span>Обсуждение и советы</span>
                  <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
                </div>
              </div>
            </div>
            <!-- Субкатегория 7в -->
            <div class="sub-category">
              <div class="sub-category-header" onclick="toggleSubCategory('sub7c'); event.stopPropagation();">
                <span>Группы по здоровому образу жизни</span>
                <span id="icon-sub7c">+</span>
              </div>
              <div id="sub7c" class="sub-chat-list">
                <div class="chat-item">
                  <span>Информация и поддержка</span>
                  <button class="btn" onclick="alert('Функция вступления в группу в стадии разработки!'); event.stopPropagation();">Вступить</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Аудиоплеер (расположен внизу, как в index.html) -->
      <div id="audio-player">
        <button id="mute-toggle">🔇</button>
        <input id="seekbar" type="range" min="0" value="0" step="1">
        <span id="current-time">0:00</span> / <span id="duration">0:00</span>
      </div>
      <audio id="bgAudio" src="Audio1_calm_music.mp3" autoplay muted loop></audio>
    </main>
  </div>
  
  <script>
    /* Функция для авто-закрытия остальных категорий */
    function toggleCategory(id) {
      document.querySelectorAll('.chat-list').forEach(list => {
        if (list.id !== id) {
          list.style.display = "none";
          var icon = document.getElementById("icon-" + list.id);
          if (icon) icon.textContent = "+";
        }
      });
      var list = document.getElementById(id);
      var icon = document.getElementById("icon-" + id);
      if (list.style.display === "flex") {
        list.style.display = "none";
        icon.textContent = "+";
      } else {
        list.style.display = "flex";
        icon.textContent = "−";
      }
    }
    
    /* Функция для переключения субкатегорий */
    function toggleSubCategory(id) {
      // Закрываем все субкатегории в родительском блоке
      var parent = document.getElementById(id).parentElement.parentElement;
      parent.querySelectorAll('.sub-chat-list').forEach(subList => {
        if (subList.id !== id) {
          subList.style.display = "none";
          var icon = document.getElementById("icon-" + subList.id);
          if (icon) icon.textContent = "+";
        }
      });
      var subList = document.getElementById(id);
      var icon = document.getElementById("icon-" + id);
      if (subList.style.display === "block") {
        subList.style.display = "none";
        icon.textContent = "+";
      } else {
        subList.style.display = "block";
        icon.textContent = "−";
      }
    }
    
    /* Инициализация Telegram Web Apps и аудиоплеера */
    window.addEventListener('load', function() {
      if (window.Telegram && Telegram.WebApp) {
        Telegram.WebApp.ready();
        setTimeout(() => Telegram.WebApp.requestFullscreen(), 100);
        if (Telegram.WebApp.BackButton) {
          Telegram.WebApp.BackButton.show();
          Telegram.WebApp.BackButton.onClick(() => location.replace('index.html'));
        }
        if (Telegram.WebApp.CloseButton) Telegram.WebApp.CloseButton.hide();
      }
      // Гарантированно переводим аудиоплеер в режим muted при входе
      var audio = document.getElementById('bgAudio');
      audio.muted = true;
      audio.play().catch(() => {});
    });
    
    /* Аудиоплеер */
    const audio = document.getElementById('bgAudio');
    const muteToggle = document.getElementById('mute-toggle');
    const seekbar = document.getElementById('seekbar');
    const currentTimeSpan = document.getElementById('current-time');
    const durationSpan = document.getElementById('duration');
    
    audio.addEventListener('loadedmetadata', () => {
      seekbar.max = Math.floor(audio.duration);
      durationSpan.textContent = formatTime(audio.duration);
    });
    audio.addEventListener('timeupdate', () => {
      seekbar.value = Math.floor(audio.currentTime);
      currentTimeSpan.textContent = formatTime(audio.currentTime);
    });
    muteToggle.addEventListener('click', () => {
      audio.muted = !audio.muted;
      muteToggle.textContent = audio.muted ? '🔇' : '🔊';
    });
    seekbar.addEventListener('input', () => {
      audio.currentTime = seekbar.value;
    });
    
    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
    }
  </script>
</body>
</html>
